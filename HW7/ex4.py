from Crypto.PublicKey import RSA
import math
from Crypto.Hash import SHA256

def square_multiply(a, x, n):
    out = 1
    for i in bin(x)[2:]:
        out = out**2 % n
        if i == "1":
            out = (a * out) % n
    return out

public_key = open('mykey.pem.pub','r').read()
rsakey = RSA.importKey(public_key)
# public key
public_key_n = rsakey.n
public_key_e = rsakey.e

# random 1024-bit number obtained from https://numbergenerator.org/random-1024-bit-binary-number
s = int("1101100000111100000101000111101100000000111010000000101110100001000101110100001011001110001000010001111001000100100111000101110000011111101111000010000001101111111100101111110101000011111000011111010001000010101000010110100101100101001010110101111011001111001101000101010111000001011011110010010010110101110101100000111111100000110101010111011101101110101111111011111001011100101101011100001100010001111001011011010010001011100010010000111100000110110000011101011010001010110110001000100111101110001111101100100111000000101000011001011110011010011110110000110100010001011100110101000010101110000100000011100000110101110011010011101001011100001110110010111000100010010101101110000111110110110010111001100111110010101111100111100000101110010111100100101011010011011000011100100001011000111110011110100101110011011001111000011100000100011000001011110001100110101001000111000010000001100100111111100101011111111111100111111000011001110111110100111011011100101110001010111110100001010101100101010011110010010000001000001000110110",2)

x = square_multiply(s, public_key_e, public_key_n)

print("Signature sent on behalf of Alice: ", s, "\n")
print("Message sent on behalf of Alice: ", x, "\n")

x_prime = square_multiply(s, public_key_e, public_key_n)

print("Signature computed by Bob: ", x_prime, "\n")

assert x == x_prime

if x == x_prime:
    print("the signature received is a valid signature for the message.")